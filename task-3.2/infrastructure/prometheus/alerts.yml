groups:
  - name: transaction_guardian_alerts
    rules:
      # ALERTA: Zero transa√ß√µes
      - alert: ZeroTransactions
        expr: transaction_guardian_current_count == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "üö® CRITICAL: Zero transa√ß√µes detectado!"
          description: "Nenhuma transa√ß√£o nos √∫ltimos minutos. Poss√≠vel outage."

      # ALERTA: Volume muito baixo
      - alert: LowVolume
        expr: transaction_guardian_current_count < 50
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "‚ö†Ô∏è WARNING: Volume baixo"
          description: "Volume atual: {{ $value }} (abaixo de 50)"

      # ALERTA: Alta taxa de anomalias
      - alert: HighAnomalyRate
        expr: (transaction_guardian_anomalies / transaction_guardian_total) > 0.1
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "‚ö†Ô∏è WARNING: Alta taxa de anomalias"
          description: "Mais de 10% das transa√ß√µes s√£o anomalias"

      # ALERTA: Taxa de aprova√ß√£o baixa
      - alert: LowApprovalRate
        expr: transaction_guardian_approval_rate < 0.9
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "üö® CRITICAL: Taxa de aprova√ß√£o baixa"
          description: "Taxa de aprova√ß√£o: {{ $value | humanizePercentage }}"

      # ALERTA: Spike de volume
      - alert: VolumeSpike
        expr: transaction_guardian_current_count > (transaction_guardian_avg_count * 2)
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "‚ö†Ô∏è WARNING: Spike de volume"
          description: "Volume atual muito acima da m√©dia"
